<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat bot</title>
    <link rel="stylesheet" href="select.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
</head>
<body >
    <!DOCTYPE html>
<html lang="en">
<head>
  <title>Chat bot</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
 <link href="https://fonts.googleapis.com/css?family=Nunito:600,700,900" rel="stylesheet">




</head>
<body id="body">
<div id="login-card" class="card">
<div class="card-body">
  <h2 class="text-center">Login form</h2>
  <br>
  
    <div class="form-group">
      <input type="text" class="form-control" id="address" placeholder="Enter address" name="address">
    </div>
    <div class="form-group">
      <input type="password" class="form-control" id="password" placeholder="Enter password" name="pswd">
    </div>
    <button type="button"  id="button"  onclick="bhej()" class="btn btn-primary deep-purple btn-block ">Submit</button>
<br>
    <br>
   
   

  
</div>
<div>      
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
      crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.7.4/web3.min.js"
      integrity="sha512-oMd9Re3VgJcXuZJn9DN6X7S7JUc7xLYZ2UyZ85Mm/xzaW3lwBr4fV2zjuu/n5jY/Of/2JOx35CTa6zvQNxb31Q=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
<script src="../elliptic-master/dist/elliptic.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/web3@1.6.0/dist/web3.min.js"></script>
    <script>


var myaccount = localStorage.getItem("myaddress");

window.onload = function() {
  //console.log(myaccount);
  if (myaccount != null) {
    window.location.replace('account.html');
  }
}

function bhej() {
  var address = document.getElementById("address").value;
  var password = document.getElementById("password").value;

  const web3 = new Web3(new Web3.providers.HttpProvider('http://127.0.0.1:7545'));

  // Vérifier controle de saisie
  
  if (!address) {
    alert("Please enter your public key");
    return;
  }

  if (!password) {
    alert("Please enter your private key");
    return;
  }

  web3.eth.getAccounts((err, accounts) => {
    if (err) {
      console.error(err);
      return;
    }

    if (!accounts.includes(address)) {
      // Afficher un message d'erreur
      alert("The specified address is not present on Ganache");
    } else{

localStorage.setItem("myaddress", address);
        window.location.replace('account.html');
}
      // Vérifier si la clé privée correspond à la clé publique
   
   
  /*


const publicKey= getPublicKeyFromPrivateKey(password);
      if (publicKey.toLowerCase() == address.toLowerCase()) {
        // Si la clé privée correspond à la clé publique, enregistrer l'adresse dans le stockage local et rediriger vers la page de compte
        localStorage.setItem("myaddress", address);
        window.location.replace('account.html');
      } else {
        alert("The private key does not correspond to this public key");
      }*/


    
  });


}


        

 
    </script>
    </body>

</html>
